# 多用户即时通讯系统

## 需求分析

* 用户登录：通过账号和密码登录
* 拉取在线用户列表：客户端向 服务器发送请求，服务器将在线用户列表传回
* 私聊：指定用户后发送消息；发送文件，向指定用户发送本地路径下的文件到对方的电脑路径
* 群聊：向所有的在线用户发送消息
* 无异常退出：区别于单机版，客户端的退出需要与服务端协调 ，做到无异常退出
* 服务器推送新闻：服务器向所有的在线用户发送消息

## 服务端和客户端的Socket编程

### 服务端

* 因为可能有多个客户端向服务端请求服务，为了各个客户端的请求互不影响，每个客户端与服务端连接的socket都被一个独立的线程持有
* 服务端可能需要向所有的socket群发消息，所有需要管理所有的与客户端相连的socket，这里采用Hashmap来实现

### 客户端

* 为了统一与服务端的文件传输形式，统一用Message或者User对象包装数据后通过对象处理流来传输
* 文件传输和消息传输采用不同的socket，同服务端客户端的socket也 需要使用hashmap进行管理

![image-20211122143047472](https://i.loli.net/2021/11/22/FjxLCWshRNHtGMK.png)

